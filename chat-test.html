<!DOCTYPE html>
<html>
<head>
  <title>Chat Test</title>
</head>
<body>
  <h2>Booking Chat</h2>
  <input type="text" id="bookingId" placeholder="Enter Booking ID" />
  <input type="text" id="userId" placeholder="Enter Your User ID" />
  <button onclick="joinRoom()">Join Room</button>

  <div id="chat-box" style="margin-top: 20px; border: 1px solid black; padding: 10px;"></div>

  <input type="text" id="messageInput" placeholder="Type a message..." />
  <button onclick="sendMessage()">Send</button>

  <script src="https://cdn.socket.io/4.7.1/socket.io.min.js"></script>
  <script>
    const socket = io("http://localhost:5002");

    let bookingId = "";
    let userId = "";

    function joinRoom() {
      bookingId = document.getElementById("bookingId").value;
      userId = document.getElementById("userId").value;

      socket.emit("joinRoom", bookingId);
      // alert(`Joined room: room-${bookingId}`);
    }

    socket.on("message", (data) => {
      const chatBox = document.getElementById("chat-box");
      const msg = document.createElement("p");
      msg.innerText = `${data.sender}: ${data.message.message}`;
      chatBox.appendChild(msg);
    console.log("Message received via WebSocket:", data);
    });

    // function sendMessage() {
    //   const msgText = document.getElementById("messageInput").value;

    //   // simulate POST API to /api/messages with fetch()
    //   fetch("http://localhost:5002/api/v1/messages", {
    //     method: "POST",
    //     headers: {
    //       "Content-Type": "application/json",
    //       // include your token here if using JWT
    //     },
    //     body: JSON.stringify({
    //       bookingId: bookingId,
    //       message: msgText
    //     })
    //   })
    //   .then(res => res.json())
    //   .then(data => {
    //     console.log("Message sent via REST:", data);
    //   })
    //   .catch(err => console.error("Error:", err));
    // }
  </script>
</body>
</html>
